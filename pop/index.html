<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Order Form</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.16.0/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
  <script>
    async function sendOrder(event) {
      event.preventDefault();

      const items = Array.from(document.querySelectorAll('.item')).map(item => ({
        name: item.querySelector('.item_name').value,
        quantity: item.querySelector('.item_quantity').value,
        type: item.querySelector('.item_type').value
      }));

      const order = { items };

      try {
        const response = await fetch('https://script.google.com/macros/s/AKfycbwOrRxhTNRXXkuYKyxis-PzDDlsaG7LMY5mk9jVU1641yVTcODF0nF-T2JhqYixgC8T/exec', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(order)
        });

        const result = await response.text();
        alert(result);
      } catch (error) {
        console.error('Error sending order:', error);
      }
    }

    function addItem() {
      const itemContainer = document.createElement('div');
      itemContainer.className = 'item form-row align-items-center';
      itemContainer.innerHTML = `
        <div class="col-sm-4 my-1">
          <input type="text" class="form-control item_name" placeholder="Item name" />
        </div>
        <div class="col-sm-2 my-1">
          <input type="number" class="form-control item_quantity" placeholder="Quantity" />
        </div>
        <div class="col-sm-4 my-1">
          <select class="form-control item_type">
            <option value="food">Food</option>
            <option value="drink">Drink</option>
          </select>
        </div>
        <div class="col-auto my-1">
          <button type="button" class="btn btn-danger" onclick="removeItem(this)">Remove</button>
        </div>
      `;
      document.getElementById('items').appendChild(itemContainer);
    }

    function removeItem(button) {
      button.closest('.item').remove();
    }
  </script>
</head>
<body style="background-image: url('https://www.appsheet.com:443/fsimage.png?appid=8c075673-1362-4c7d-a224-ae4d77ec8b55&datasource=google&filename=DocId%3D1WN57FBbTSAa3yMWYXmHyD32_qDNO4OKM&signature=307d98512916cbd66cd558605228f6ed824b1101ab4824964ff2f03bbe351304&tableprovider=google&userid=1132152');">
  <div class="container" style="width:1400px; height: 1024px; ">
    <h1 class="mt-5">Order Form</h1>
    <form onsubmit="sendOrder(event)">
      <div id="items" class="items mb-3">
        <div class="item form-row align-items-center">
          <div class="col-sm-4 my-1">
            <input type="text" class="form-control item_name" placeholder="Item name" />
          </div>
          <div class="col-sm-2 my-1">
            <input type="number" class="form-control item_quantity" placeholder="Quantity" />
          </div>
          <div class="col-sm-4 my-1">
            <select class="form-control item_type">
              <option value="food">Food</option>
              <option value="drink">Drink</option>
            </select>
          </div>
        </div>
      </div>
      <button type="button" class="btn btn-primary mb-3" onclick="addItem()">Add Item</button>
      <button type="submit" class="btn btn-success mb-3">Send Order</button>
    </form>
  </div>
</body>
</html>