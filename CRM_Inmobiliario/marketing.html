<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>CRM - Marketing</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="js/app.js"></script>
</head>
<body class="bg-gray-100 p-6">

<header class="bg-gray-200 p-4 flex gap-4 mb-4">
  <a href="index.html">Dashboard</a>
  <a href="clientes.html">Clientes</a>
  <a href="propiedades.html">Propiedades</a>
  <a href="visitas.html">Visitas</a>
  <a href="marketing.html" class="font-bold">Marketing</a>
</header>

<h1 class="text-2xl font-bold mb-4">Marketing</h1>

<table class="w-full bg-white rounded shadow mb-4">
<thead>
<tr class="bg-gray-200 text-left">
<th class="p-2">Canal</th>
<th class="p-2">Inversión</th>
<th class="p-2">Clientes Captados</th>
<th class="p-2">Leads</th>
</tr>
</thead>
<tbody id="tablaMarketing"></tbody>
</table>

<div class="max-w-md mb-4">
<canvas id="graficoMarketing"></canvas>
</div>

<script>
let marketingGlobal=[];
async function cargarMarketing(){
  marketingGlobal = await fetchData("Marketing");
  document.getElementById("tablaMarketing").innerHTML = marketingGlobal.map(m=>`
    <tr class="border-b">
      <td class="p-2">${m.Canal}</td>
      <td class="p-2">$${m.Inversion}</td>
      <td class="p-2">${m["Clientes Captados"]}</td>
      <td class="p-2">${m.Leads}</td>
    </tr>
  `).join("");

  const etiquetas = marketingGlobal.map(m=>m.Canal);
  const clientes = marketingGlobal.map(m=>m["Clientes Captados"]);
  const inversion = marketingGlobal.map(m=>m.Inversion);

  new Chart(document.getElementById("graficoMarketing"),{
    type:"bar",
    data:{labels:etiquetas,datasets:[{label:"Clientes Captados",data:clientes,backgroundColor:"#3B82F6"},{label:"Inversión",data:inversion,backgroundColor:"#FACC15"}]},
    options:{responsive:true,maintainAspectRatio:false}
  });
}

cargarMarketing();
</script>
</body>
</html>