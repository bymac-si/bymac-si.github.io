<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<title>CRM Inmobiliario - Administración</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="assets/css/styles.css">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-doughnutlabel-rebourne"></script>
<script src="assets/js/app.js"></script>
<script>
  requireAuth();
</script>
</head>
<body style="max-width:1200px; margin: 0 auto;">

<!-- NAV -->
<div id="header"></div>

<!-- CONTENIDO -->
<main style="padding:40px;">
  <h1 id="tituloPagina" style="font-size:28px; font-weight:600; color:#1A2B48; margin-bottom:20px;">
    Administración
  </h1>

  <div style="display:flex; gap:10px; align-items:center; margin-bottom:16px;">
    <button id="btnNuevo" class="btn-primary">+ Nuevo</button>
    <input id="filtro" type="text" placeholder="Buscar..." style="flex:1; padding:8px; border:1px solid #e5e7eb; border-radius:4px;">
  </div>

  <table>
    <thead id="tablaHead"></thead>
    <tbody id="tablaBody"></tbody>
  </table>
</main>

<!-- MODAL: Crear/Editar Usuario o Agente -->
<div id="modalEntidad" class="modal">
  <div class="modal-content">
    <h2 id="modalTitleEntidad">Nuevo</h2>
    <form id="formEntidad">
      <input type="hidden" id="entidadID">

      <div id="camposUsuario">
        <input type="email" id="usuarioEmail" placeholder="Correo corporativo">
        <input type="text" id="usuarioNombre" placeholder="Nombre completo">
        <select id="usuarioRol">
          <option value="Colaborador">Colaborador</option>
          <option value="Admin">Admin</option>
        </select>
        <select id="usuarioActivo">
          <option value="SI">Activo</option>
          <option value="NO">Inactivo</option>
        </select>
      </div>

      <div id="camposAgente">
        <input type="text" id="agenteNombre" placeholder="Nombre completo">
        <input type="text" id="agenteEmail" placeholder="Correo">
        <input type="text" id="agenteTelefono" placeholder="Teléfono">
        <select id="agenteActivo">
          <option value="SI">Activo</option>
          <option value="NO">Inactivo</option>
        </select>
      </div>

      <div style="display:flex; justify-content:flex-end; gap:10px; margin-top:12px;">
        <button type="button" onclick="cerrarModalEntidad()" class="btn-primary">Cancelar</button>
        <button type="submit" class="btn-primary">Guardar</button>
      </div>
    </form>
  </div>
</div>

<!-- MODAL: Tareas de Agente -->
<div id="modalTareas" class="modal">
  <div class="modal-content">
    <h2 id="modalTitleTareas">Tareas del Agente</h2>
    <div style="margin-bottom:10px;">
      <button id="btnNuevaTarea" class="btn-primary">Nueva Tarea</button>
    </div>
    <table>
      <thead><tr><th>Título</th><th>Estado</th><th>Prioridad</th><th>Fecha Límite</th><th>Acciones</th></tr></thead>
      <tbody id="tablaTareas"></tbody>
    </table>
    <div style="margin-top:12px; text-align:right;">
      <button type="button" onclick="cerrarModalTareas()" class="btn-primary">Cerrar</button>
    </div>
  </div>
</div>

<!-- MODAL FORM TAREA -->
<div id="modalFormTarea" class="modal">
  <div class="modal-content">
    <h2 id="modalTitleTarea">Nueva Tarea</h2>
    <form id="formTarea">
      <input type="hidden" id="tareaID">
      <input type="hidden" id="tareaAgenteID">

      <label>Título</label>
      <input type="text" id="tareaTitulo" required>

      <label>Descripción</label><br>
      <textarea id="tareaDescripcion" rows="3"></textarea>
<br><br>
      <label>Estado</label>
      <select id="tareaEstado">
        <option value="Pendiente">Pendiente</option>
        <option value="En Progreso">En Progreso</option>
        <option value="Completada">Completada</option>
      </select>

      <label>Prioridad</label>
      <select id="tareaPrioridad">
        <option value="Baja">Baja</option>
        <option value="Media">Media</option>
        <option value="Alta">Alta</option>
      </select>

      <label>Fecha Límite</label>
      <input type="date" id="tareaFechaLimite">

      <label>Comentarios</label><br>
      <textarea id="tareaComentarios" rows="2"></textarea>

      <div style="display:flex; justify-content:flex-end; gap:10px; margin-top:12px;">
        <button type="button" class="btn-primary" onclick="cerrarFormTarea()">Cancelar</button>
        <button type="submit" class="btn-primary">Guardar</button>
      </div>
    </form>
  </div>
</div>

<div id="footer"></div>

<script src="assets/js/pages/usuarios.inline.js"></script>
</body>
</html>