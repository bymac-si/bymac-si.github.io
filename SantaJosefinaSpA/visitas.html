<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>CRM - Gestión de Visitas</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link rel="stylesheet" href="assets/css/styles.css" />
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#1a2b48">
<link rel="apple-touch-icon" href="assets/img/icon-192.png">

    <script src="assets/js/app.js"></script>
    <script>
      requireAuth();
    </script>

    
      <link rel="stylesheet" href="assets/css/pages/visitas.inline.css">
</head>
  <body>
    <div id="header"></div>

    <main>
      <div class="dashboard-header no-print">
        <div class="header-top">
          <h1 class="page-title">Gestión de Visitas</h1>

          <div class="header-actions">
            <button
              class="btn-head btn-secundario"
              id="btnReload"
              title="Recargar datos"
            >
              <i class="fa-solid fa-rotate-right"></i>
              <span class="btn-text">Recargar</span>
            </button>

            <button
              class="btn-head btn-secundario"
              id="btnExport"
              title="Descargar CSV"
            >
              <i class="fa-solid fa-file-csv"></i>
              <span class="btn-text">Exportar</span>
            </button>

            <button
              class="btn-head btn-secundario"
              onclick="window.print()"
              title="Imprimir vista"
            >
              <i class="fa-solid fa-print"></i>
              <span class="btn-text">Imprimir</span>
            </button>

            <button class="btn-head btn-nuevo" id="btnNew">
              <i class="fa-solid fa-plus"></i>
              <span>Nueva Visita</span>
            </button>
          </div>
        </div>

        <div class="header-filters">
          <div class="filter-item" style="flex-grow: 1">
            <label class="label">Buscar</label>
            <input
              id="inpBuscar"
              class="input-modern"
              placeholder="Cliente, propiedad, agente, fecha..."
              type="text"
            />
          </div>
        </div>
      </div>

      <table>
        <thead>
          <tr>
            <th>Cliente</th>
            <th>Propiedad</th>
            <th>Fecha</th>
            <th>Agente</th>
            <th class="no-print" style="width: 140px">Acciones</th>
          </tr>
        </thead>
        <tbody id="tablaVisitas">
          <tr>
            <td colspan="5" class="muted">Cargando datos...</td>
          </tr>
        </tbody>
      </table>
    </main>

    <div id="modalVisita" class="modal" aria-hidden="true">
      <div class="modal-content">
        <h2 id="modalTitleVisita" style="margin-top: 0">Nueva Visita</h2>
        <form id="formVisita" style="margin-top: 20px">
          <input type="hidden" id="visitaID" />

          <div style="display: flex; flex-direction: column; gap: 12px">
            <div>
              <label class="label">Cliente</label>
              <select id="visitaCliente" required></select>
            </div>
            <div>
              <label class="label">Propiedad</label>
              <select id="visitaPropiedad" required></select>
            </div>
            <div>
              <label class="label">Fecha</label>
              <input type="date" id="visitaFecha" required />
            </div>
            <div>
              <label class="label">Agente</label>
              <input id="visitaAgente" />
            </div>
          </div>

          <div style="text-align: right; margin-top: 20px">
            <button
              type="button"
              class="btn-primary"
              style="background: #6c757d; border: none"
              onclick="cerrarModalVisita()"
            >
              Cancelar
            </button>
            <button class="btn-primary" style="border: none">Guardar</button>
          </div>
        </form>
      </div>
    </div>

    <div id="modalDetalle" class="modal" aria-hidden="true">
      <div class="modal-content">
        <h2 style="margin-top: 0">Detalle Visita</h2>
        <div id="detalleContenido" style="margin: 20px 0"></div>
        <div style="text-align: right">
          <button
            class="btn-primary"
            type="button"
            onclick="cerrarModalDetalle()"
            style="background: #6c757d; border: none"
          >
            Cerrar
          </button>
        </div>
      </div>
    </div>

    <div id="pageSpinner" class="spinner-backdrop" aria-hidden="true">
      <div class="spinner-card">
        <div class="spinner"></div>
        <div id="spinnerText">Cargando…</div>
      </div>
    </div>

    <div id="footer"></div>

    <script src="assets/js/pages/visitas.inline.js"></script>
  </body>
</html>