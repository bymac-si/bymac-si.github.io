<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>CRM - Gesti√≥n de Espacios</title>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <link rel="stylesheet" href="assets/css/styles.css" />
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#1a2b48">
<link rel="apple-touch-icon" href="assets/img/icon-192.png">

    <script src="assets/js/app.js"></script>
    <script>
      requireAuth();
    </script>

    
      <link rel="stylesheet" href="assets/css/pages/admin-espacios.inline.css">
</head>
  <body>
    <div id="header"></div>

    <main>
      <div class="dashboard-header">
        <div class="header-top">
          <div>
            <h1 class="page-title">Espacios Comunes</h1>
            <p style="margin: 5px 0 0; color: #64748b; font-size: 14px">
              Gestiona Quinchos, Salas, Piscinas y sus horarios.
            </p>
          </div>
          <button class="btn-main" onclick="abrirModalEspacio()">
            <i class="fa-solid fa-plus"></i> Nuevo Espacio
          </button>
        </div>

        <div class="header-filters">
          <div class="filter-group" style="max-width: 400px">
            <label class="label">Comunidad</label>
            <select
              id="filtroCopropiedad"
              class="input-modern"
              onchange="cargarEspacios()"
            >
              <option value="">Cargando...</option>
            </select>
          </div>
        </div>
      </div>

      <div id="gridEspacios" class="grid-espacios">
        <div
          style="
            grid-column: 1/-1;
            text-align: center;
            padding: 40px;
            color: #94a3b8;
          "
        >
          <i class="fa-solid fa-spinner fa-spin"></i> Cargando espacios...
        </div>
      </div>
    </main>

    <div id="modalEspacio" class="modal">
      <div class="modal-content">
        <h2 id="modalTitleEspacio" style="margin-top: 0">Nuevo Espacio</h2>
        <form id="formEspacio">
          <input type="hidden" id="eID" />
          <input type="hidden" id="eCopropiedadID" />

          <div style="display: grid; grid-template-columns: 2fr 1fr; gap: 15px">
            <div>
              <label class="label">Nombre del Espacio</label>
              <input
                id="eNombre"
                class="input-modern"
                required
                placeholder="Ej: Quincho Torre A"
              />
            </div>
            <div>
              <label class="label">Icono (Si no hay foto)</label>
              <select id="eIcono" class="input-modern">
                <option value="fa-building">üè¢ Edificio</option>
                <option value="fa-fire-burner">üî• Quincho</option>
                <option value="fa-champagne-glasses">ü•Ç Eventos</option>
                <option value="fa-person-swimming">üèä Piscina</option>
                <option value="fa-car">üöó Estac.</option>
                <option value="fa-shirt">üëï Lavander√≠a</option>
                <option value="fa-dumbbell">üí™ Gimnasio</option>
              </select>
            </div>
          </div>

          <div
            style="
              display: grid;
              grid-template-columns: 1fr 1fr;
              gap: 15px;
              margin-top: 15px;
            "
          >
            <div>
              <label class="label">Capacidad (Personas)</label>
              <input
                id="eCapacidad"
                type="number"
                class="input-modern"
                placeholder="Ej: 20"
              />
            </div>
            <div>
              <label class="label">Estado</label>
              <select id="eEstado" class="input-modern">
                <option value="Activo">Activo ‚úÖ</option>
                <option value="Mantencion">En Mantenci√≥n üõ†Ô∏è</option>
                <option value="Inactivo">Inactivo ‚ùå</option>
              </select>
            </div>
          </div>

          <div
            style="
              display: grid;
              grid-template-columns: 1fr 1fr;
              gap: 15px;
              margin-top: 15px;
            "
          >
            <div>
              <label class="label">Costo Reserva ($)</label>
              <input id="eCosto" type="number" class="input-modern" value="0" />
            </div>
            <div>
              <label class="label">Garant√≠a ($)</label>
              <input
                id="eGarantia"
                type="number"
                class="input-modern"
                value="0"
              />
            </div>
          </div>

          <label class="label" style="margin-top: 15px"
            >URL Imagen (Opcional)</label
          >
          <input id="eImagen" class="input-modern" placeholder="https://..." />

          <label class="label" style="margin-top: 15px">Reglas de Uso</label>
          <textarea
            id="eReglas"
            class="input-modern"
            rows="2"
            placeholder="Ej: Se debe entregar limpio antes de las 10 AM."
          ></textarea>

          <div style="text-align: right; margin-top: 25px">
            <button
              type="button"
              class="btn-sm"
              onclick="document.getElementById('modalEspacio').style.display='none'"
            >
              Cancelar
            </button>
            <button type="submit" class="btn-main">Guardar Espacio</button>
          </div>
        </form>
      </div>
    </div>

    <div id="modalBloques" class="modal">
      <div class="modal-content" style="max-width: 700px">
        <div
          style="
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
  ;
          "
        >
          <h2 style="margin: 0">Configurar Horarios</h2>
          <button
            class="btn-sm"
            onclick="document.getElementById('modalBloques').style.display='none'"
          >
            Cerrar
          </button>
        </div>

        <p class="label" id="bloqueSubtitle" style="color: #1a2b48">
          Espacio: ...
        </p>
        <input type="hidden" id="bEspacioID" />

        <div
          style="
            background: #f8fafc;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #e2e8f0;
            margin-bottom: 15px;
          "
        >
          <div
            style="
              display: grid;
              grid-template-columns: 2fr 1fr 1fr auto;
              gap: 10px;
              align-items: end;
              max-width: 45px;
            "
          >
            <div>
              <label class="label">Nombre Bloque</label>
              <input
                id="bNombre"
                class="input-modern"
                style="height: 35px;"
                placeholder="Ej: Almuerzo"
                
              />
            </div>
            <div>
              <label class="label">Inicio</label>
              <input
                id="bInicio"
                type="time"
                class="input-modern"
                style="height: 35px;"
              />
            </div>
            <div>
              <label class="label">Fin</label>
              <input
                id="bFin"
                type="time"
                class="input-modern"
                style="height: 35px;"
              />
            </div>
            <button
              type="button"
              class="btn-main"
              onclick="agregarBloque()"
              style="height: 35px; padding: 10px;position: relative; top:-12px; left:6px;">
              <i class="fa-solid fa-plus"></i>
            </button>
          </div>
        </div>

        <table class="table-bloques">
          <thead>
            <tr>
              <th>Nombre</th>
              <th>Horario</th>
              <th style="text-align: right">Acci√≥n</th>
            </tr>
          </thead>
          <tbody id="listaBloques">
            <tr>
              <td colspan="3" style="text-align: center; padding: 20px">
                Cargando horarios...
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <div id="pageSpinner" class="spinner-overlay">
      <div style="text-align: center">
        <div class="spinner"></div>
        <div style="margin-top: 10px; font-weight: 600; color: #1a2b48">
          Procesando...
        </div>
      </div>
    </div>

    <div id="footer"></div>

    <script src="assets/js/pages/admin-espacios.inline.js"></script>
  </body>
</html>
